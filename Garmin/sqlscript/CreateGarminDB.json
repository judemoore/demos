{
	"name": "CreateGarminDB",
	"properties": {
		"description": "Create GarminFiles DB and view for the activites data",
		"content": {
			"query": "USE MASTER\nGO\n\n-- Drop database if it exists\nDROP DATABASE IF EXISTS GarminFiles\nGO\n\n-- Create new database\nCREATE DATABASE [GarminFiles]\nGO\n\nUSE GarminFiles\nGO\n\n\n-- There is no credential in data surce. We are using public storage account which doesn't need a secret.\nCREATE EXTERNAL DATA SOURCE MyGarminPQfiles\nWITH ( LOCATION = 'https://personalprojectsrslake.dfs.core.windows.net/')\nGO\n\nDROP VIEW IF EXISTS vwGarminActivity\nGO\n\nCREATE VIEW vwGarminActivity AS\nSELECT *\nFROM\n    OPENROWSET\n        (\n        BULK '/personalprojectsfs/synapse/workspaces/personalprojectsrgsynapse/DataFiles/Garmin/garmin_get_activities_by_date-2*.parquet',\n        DATA_SOURCE = 'MyGarminPQfiles',\n        FORMAT='PARQUET'\n        )\n        WITH\n            (\n                [activityId] BIGINT,\n                [activityName] VARCHAR (255),\n                [startTimeLocal] DATETIME2,\n                [startTimeGMT] DATETIME2,\n                [distance] FLOAT,\n                [duration] FLOAT,\n                [elapsedDuration] FLOAT,\n                [movingDuration] FLOAT,\n                [averageSpeed] FLOAT,\n                [hasPolyline] BIT,\n                [hasImages] BIT,\n                [ownerId] BIGINT,\n                [ownerDisplayName] VARCHAR (255),\n                [ownerFullName] VARCHAR (255),\n                [ownerProfileImageUrlSmall] VARCHAR (255),\n                [ownerProfileImageUrlMedium] VARCHAR (255),\n                [ownerProfileImageUrlLarge] VARCHAR (255),\n                [calories] FLOAT,\n                [bmrCalories] FLOAT,\n                [averageHR] FLOAT,\n                [maxHR] FLOAT,\n                [steps] FLOAT,\n                [userRoles] VARCHAR (255),\n                [userPro] BIT,\n                [hasVideo] BIT,\n                [timeZoneId] BIGINT,\n                [beginTimestamp] BIGINT,\n                [sportTypeId] BIGINT,\n                [deviceId] BIGINT,\n                [summarizedExerciseSets] VARCHAR (255),\n                [manufacturer] VARCHAR (255),\n                [lapCount] FLOAT,\n                [waterEstimated] FLOAT,\n                [totalSets] FLOAT,\n                [activeSets] FLOAT,\n                [totalReps] BIGINT,\n                [minActivityLapDuration] FLOAT,\n                [splitSummaries] VARCHAR (255),\n                [hasSplits] BIT,\n                [moderateIntensityMinutes] BIGINT,\n                [vigorousIntensityMinutes] BIGINT,\n                [differenceBodyBattery] BIGINT,\n                [pr] BIT,\n                [autoCalcCalories] BIT,\n                [elevationCorrected] BIT,\n                [atpActivity] BIT,\n                [favorite] BIT,\n                [decoDive] BIT,\n                [parent] BIT,\n                [purposeful] BIT,\n                [manualActivity] BIT,\n                [activityType.typeId] BIGINT,\n                [activityType.typeKey] VARCHAR (255),\n                [activityType.parentTypeId] BIGINT,\n                [activityType.isHidden] BIT,\n                [activityType.restricted] BIT,\n                [activityType.trimmable] BIT,\n                [eventType.typeId] BIGINT,\n                [eventType.typeKey] VARCHAR (255),\n                [eventType.sortOrder] BIGINT,\n                [privacy.typeId] BIGINT,\n                [privacy.typeKey] VARCHAR (255),\n                [summarizedDiveInfo.summarizedDiveGases] FLOAT,\n                [elevationGain] FLOAT,\n                [elevationLoss] FLOAT,\n                [maxSpeed] FLOAT,\n                [startLatitude] FLOAT,\n                [startLongitude] FLOAT,\n                [averageRunningCadenceInStepsPerMinute] FLOAT,\n                [maxRunningCadenceInStepsPerMinute] FLOAT,\n                [avgStrideLength] FLOAT,\n                [minElevation] FLOAT,\n                [maxElevation] FLOAT,\n                [maxDoubleCadence] FLOAT,\n                [maxVerticalSpeed] FLOAT,\n                [locationName] VARCHAR (255),\n                [endLatitude] FLOAT,\n                [endLongitude] FLOAT,\n                [vO2MaxValue] FLOAT\n            )\n         AS uspv;\n\n\n-- Test\n-- select * from vwGarminActivity",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}